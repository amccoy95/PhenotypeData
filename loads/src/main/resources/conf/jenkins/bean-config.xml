<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
		http://www.springframework.org/schema/tx
		http://www.springframework.org/schema/tx/spring-tx-4.1.xsd
		http://www.springframework.org/schema/context
		http://www.springframework.org/schema/context/spring-context-4.1.xsd
		http://www.springframework.org/schema/util
		http://www.springframework.org/schema/util/spring-util-4.1.xsd">


	<!-- APPLICATION CONSTANTS -->
	<util:list id="COLONIES_TO_SKIP" value-type="java.lang.String">
		<value>GSF-HEPD0522_7_H06-1</value>
	</util:list>


	<!-- SPRING INSTRUCTIONS -->
	<context:annotation-config/>
	<context:component-scan base-package="uk.ac.ebi.phenotype.data.stats" />
	<tx:annotation-driven transaction-manager="transactionManager" />


	<!-- BEAN DEFINITIONS -->
	<bean id="threadPool" class="java.util.concurrent.Executors" factory-method="newFixedThreadPool" destroy-method="shutdown">
		<constructor-arg value="80" />
	</bean>

	<!--<bean id="broker" class="uk.ac.ebi.phenotype.data.stats.Broker">
		<constructor-arg value="300" />
		<constructor-arg value="Unidimensional producer/consumer broker" />
	</bean>
   -->
	<bean id="phenStatScriptFilename" class="java.lang.String">
		<constructor-arg value="PhenStat_2.1.2.R" />
	</bean>
  
  <!-- 
	<bean id="rType" class="uk.ac.ebi.phenotype.data.R.RType" factory-method="valueOf">
		<constructor-arg value="R_CLOUD" />
	</bean>
 
	<bean id="loadImagesDao" class="uk.ac.ebi.phenotype.admin.dao.LoadImagesDao">
		<property name="dataSource" ref="komp2DataSource" />
	</bean>

	<bean id="mpTermService" class="uk.ac.ebi.phenotype.data.stats.MpTermService">
		<constructor-arg ref="ontologyTermDAO" />
		<constructor-arg ref="phenotypePipelineDAO" />
	</bean>
-->
    <bean id="observationSolrServer" class="org.apache.solr.client.solrj.impl.ConcurrentUpdateSolrServer">
        <constructor-arg index="0" value="http://ves-ebi-d0.ebi.ac.uk:8090/jenkins_dev_komp2/experiment"/>
        <constructor-arg index="1" value="100000"/> <!--Queue size-->
        <constructor-arg index="2" value="10"/> <!--Num threads-->
    </bean>
 
	<bean id="observationService" class="org.mousephenotype.cda.solr.service.ObservationService">
		<constructor-arg name="solrUrl" value="http://ves-ebi-d0.ebi.ac.uk:8090/jenkins_dev_komp2/experiment" />
	</bean>
	
    <bean id="preqcService" class="org.mousephenotype.cda.solr.service.PreQcService">
        <constructor-arg value="${internalSolrUrl}/preqc" />
        <constructor-arg ref="phenotypePipelineDAO" />
    </bean>

    <bean id="postqcService" class="org.mousephenotype.cda.solr.service.PostQcService">
        <constructor-arg value="http://ves-ebi-d0.ebi.ac.uk:8090/jenkins_dev_komp2/genotype-phenotype" />
        <constructor-arg ref="phenotypePipelineDAO" />
    </bean>

	<bean id="statisticalResultDAO" class="org.mousephenotype.cda.db.dao.StatisticalResultDAOImpl">
 		<constructor-arg ref="sessionFactory" />
 	</bean>

	<bean id="experimentService" class="org.mousephenotype.cda.solr.service.ExperimentService">
	</bean>

    <bean id="statisticalResultService" class="org.mousephenotype.cda.solr.service.StatisticalResultService">
        <constructor-arg  value="http://wwwdev.ebi.ac.uk/mi/impc/dev/solr/statistical-result" />
        <constructor-arg  ref="phenotypePipelineDAO" />
    </bean>

    <bean id="unidimensionalStatisticsDAO" class="org.mousephenotype.cda.db.dao.UnidimensionalStatisticsDAOImpl">
        <constructor-arg ref="sessionFactory" />
    </bean>

    <bean id="phenotypeCallSummaryDAOSolr" class="org.mousephenotype.cda.db.pojo.PhenotypeCallSummarySolrImpl">
	</bean>

	<bean id="observationDAO" class="org.mousephenotype.cda.db.dao.ObservationDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="biologicalModelDAO" class="org.mousephenotype.cda.db.dao.BiologicalModelDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="phenotypePipelineDAO" class="org.mousephenotype.cda.db.dao.PhenotypePipelineDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="alleleDAO" class="org.mousephenotype.cda.db.dao.AlleleDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="genomicFeatureDAO" class="org.mousephenotype.cda.db.dao.GenomicFeatureDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="ontologyTermDAO" class="org.mousephenotype.cda.db.dao.OntologyTermDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="sequenceRegionDAO" class="org.mousephenotype.cda.db.dao.SequenceRegionDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="coordinateSystemDAO" class="org.mousephenotype.cda.db.dao.CoordinateSystemDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="strainDAO" class="org.mousephenotype.cda.db.dao.StrainDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="datasourceDAO" class="org.mousephenotype.cda.db.dao.DatasourceDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="projectDAO" class="org.mousephenotype.cda.db.dao.ProjectDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

	<bean id="organisationDAO" class="org.mousephenotype.cda.db.dao.OrganisationDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>
	
	<bean id="imagingSourceManager" class="uk.ac.ebi.phenotype.imaging.springrest.images.dao.HibernateImagesDao">
		<constructor-arg ref="sessionFactory" />
		<constructor-arg ref="imagesSolrDao" />
	</bean>

	<bean id="imagesSolrDao" class="org.mousephenotype.cda.solr.repositories.image.ImagesSolrJ">
		<constructor-arg name="solrBaseUrl" value="http://wwwdev.ebi.ac.uk/mi/solr/images" />
	</bean>
	
	<bean id="phenotypeCallSummaryDAO" class="org.mousephenotype.cda.db.dao.PhenotypeCallSummaryDAOImpl">
		<constructor-arg ref="sessionFactory" />
	</bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
		<property name="dataSource" ref="komp2DataSource"/>
		<property name="annotatedClasses">
			<list>
				<value>org.mousephenotype.cda.db.pojo.CountDTO</value>
				<value>org.mousephenotype.cda.db.pojo.Experiment</value>
				<value>org.mousephenotype.cda.db.pojo.Observation</value>
				<value>org.mousephenotype.cda.db.pojo.CategoricalObservation</value>
				<value>org.mousephenotype.cda.db.pojo.MetaDataObservation</value>
				<value>org.mousephenotype.cda.db.pojo.UnidimensionalObservation</value>
				<value>org.mousephenotype.cda.db.pojo.TimeSeriesObservation</value>
				<value>org.mousephenotype.cda.db.pojo.TextObservation</value>
				<value>org.mousephenotype.cda.db.pojo.BiologicalModel</value>
				<value>org.mousephenotype.cda.db.pojo.BiologicalSample</value>
				<value>org.mousephenotype.cda.db.pojo.PhenotypeCallSummary</value>
				<value>org.mousephenotype.cda.db.pojo.Parameter</value>
				<value>org.mousephenotype.cda.db.pojo.ParameterOption</value>
				<value>org.mousephenotype.cda.db.pojo.ParameterIncrement</value>
				<value>org.mousephenotype.cda.db.pojo.ParameterOntologyAnnotation</value>
				<value>org.mousephenotype.cda.db.pojo.ParameterEntityQualityAnnotation</value>
				<value>org.mousephenotype.cda.db.pojo.Procedure</value>
				<value>org.mousephenotype.cda.db.pojo.Pipeline</value>
				<value>org.mousephenotype.cda.db.pojo.Allele</value>
				<value>org.mousephenotype.cda.db.pojo.GenomicFeature</value>
				<value>org.mousephenotype.cda.db.pojo.OntologyTerm</value>
				<value>org.mousephenotype.cda.db.pojo.SequenceRegion</value>
				<value>org.mousephenotype.cda.db.pojo.CoordinateSystem</value>
				<value>org.mousephenotype.cda.db.pojo.Strain</value>
				<value>org.mousephenotype.cda.db.pojo.Datasource</value>
				<value>org.mousephenotype.cda.db.pojo.Labcode</value>
				<value>org.mousephenotype.cda.db.pojo.Project</value>
				<value>org.mousephenotype.cda.db.pojo.Organisation</value>
				<value>org.mousephenotype.cda.db.pojo.LiveSample</value>
				<value>org.mousephenotype.cda.db.pojo.CategoricalControlView</value>
				<value>org.mousephenotype.cda.db.pojo.CategoricalMutantView</value>
				<value>org.mousephenotype.cda.db.pojo.CategoricalResult</value>
				<value>org.mousephenotype.cda.db.pojo.UnidimensionalControlView</value>
				<value>org.mousephenotype.cda.db.pojo.UnidimensionalMutantView</value>
				<value>org.mousephenotype.cda.db.pojo.UnidimensionalResult</value>
				<value>org.mousephenotype.cda.db.pojo.ImaImageRecord</value>
				<value>org.mousephenotype.cda.db.pojo.ImaImageTag</value>
				<value>org.mousephenotype.cda.db.pojo.ImaImageTagType</value>
				<value>org.mousephenotype.cda.db.pojo.ImaExperimentDict</value>
				<value>org.mousephenotype.cda.db.pojo.ImaQcDict</value>
				<value>org.mousephenotype.cda.db.pojo.ImaPublishedDict</value>
				<value>org.mousephenotype.cda.db.pojo.AnnOntologyDict</value>
				<value>org.mousephenotype.cda.db.pojo.AnnAnnotation</value>
				<value>org.mousephenotype.cda.db.pojo.ImaImportContext</value>
				<value>org.mousephenotype.cda.db.pojo.ImaSubcontext</value>
				<value>org.mousephenotype.cda.db.pojo.HigherLevelAnnotation</value>
				<value>org.mousephenotype.cda.db.pojo.MtsMouseAlleleMv</value>
				<value>org.mousephenotype.cda.db.pojo.MtsMouseAllele</value>
				<value>org.mousephenotype.cda.db.pojo.MtsGenotypeDict</value>
				<value>org.mousephenotype.cda.db.pojo.AlleleMpi</value>
				<value>org.mousephenotype.cda.db.pojo.MtsMouseAllele</value>
				<value>org.mousephenotype.cda.db.pojo.MtsGenotypeDict</value>
			</list>
		</property>
		<property name="hibernateProperties">
      		<props>
             	<prop key="hibernate.dialect">org.hibernate.dialect.MySQL5Dialect</prop>
            	<prop key="hibernate.show_sql">false</prop>
            	<prop key="hibernate.connection.useUnicode">true</prop>
                <prop key="hibernate.connection.charSet">UTF8</prop>
        	</props>
    	</property>
    	
	</bean>

	<!-- Drives transactions using Hibernate APIs when requested -->
	<bean id="transactionManager"
		class="org.springframework.orm.hibernate4.HibernateTransactionManager">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	
	
	<!-- Translates Hibernate exceptions to Spring Data Access Exceptions -->
	<bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/>

</beans>
